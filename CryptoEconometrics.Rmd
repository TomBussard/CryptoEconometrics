---
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE)
```
\vspace{6cm}

\begin{figure}
    \centering
    \includegraphics[width=10cm]{logo-dauphine.jpg}
\end{figure}

\vspace{2cm}

\begin{center}    
    \large Rapport \\
    \huge \textbf{Projet Econométrie} \\
    \rule{2cm}{1pt} \\
    \vspace{0.5cm}
    \large Odend'hal Charles - Bussard Tom \\
    \vspace{1cm}
    \textbf{Sujet :} \\
    \textit{Comment la supply des stablecoins, comme l’USDT, réagit-elle à la volatilité du marché : refuge pour les investisseurs ou incitation au risque ?} \\
    \vspace{2cm} % Ajustement de l'espace après le sujet
    \large \textit{Déclaration sur l'honneur} \\
    \vspace{0.5cm}
    \textit{"Nous déclarons sur l'honneur que ce mémoire a été écrit de notre main, sans aide extérieure non autorisée, qu'il n'a pas été présenté auparavant pour évaluation et qu'il n'a jamais été publié, dans sa totalité ou en partie. Toutes parties, groupes de mots ou idées, aussi limités soient-ils, y compris des tableaux, graphiques, cartes etc. qui sont empruntes ou qui font référence à d'autres sources bibliographiques sont présentés comme tels, sans exception aucune."} \\
    \vfill    
    Décembre 2024 
    \pagebreak
\end{center}

\newpage

\tableofcontents

\newpage

# Introduction {-}

Dans le contexte économique actuel, la volatilité des marchés financiers suscite de nombreuses interrogations quant aux comportements des investisseurs et aux dynamiques des actifs financiers. Parmi ces actifs, les stablecoins, et en particulier l’USDT (Tether), jouent un rôle croissant en raison de leur lien avec les marchés des crypto-monnaies et leur promesse de stabilité relative face aux fluctuations des actifs plus volatils. Cependant, leur rôle exact dans la stratégie d’investissement reste ambigu : servent-ils de refuge pour les investisseurs en période de turbulence, ou encouragent-ils plutôt des comportements plus risqués ?

\bigskip

Ce projet vise à étudier la réaction de l’offre de l’USDT aux variations de la volatilité du marché. Plus spécifiquement, nous nous interrogeons sur la nature de cette relation : l'USDT agit-il comme un actif refuge, stabilisant les portefeuilles en périodes de fortes fluctuations, ou bien sa disponibilité accrue pousse-t-elle les investisseurs à prendre davantage de risques dans leurs stratégies d’investissement en crypto-monnaies ?

\bigskip

Pour répondre à cette question, nous appliquons une approche d’économétrie des séries temporelles. Conformément aux consignes du projet, l’analyse se décomposera en deux volets. D’abord, une modélisation univariée sera réalisée sur les séries temporelles sélectionnées, incluant des tests de racine unitaire et des modélisations ARMA, afin de déterminer les caractéristiques de stationnarité et les dynamiques internes des séries. Ensuite, une modélisation multivariée via un modèle VAR permettra d’analyser les relations entre la supply de l’USDT et d’autres variables de marché, avec une attention particulière sur les réactions aux chocs et la causalité entre les variables.

\newpage

# Description des données

Afin de mener notre analyse économétrique, nous avons rassemblé des données sur des indicateurs macroéconomiques et financiers en lien avec les stablecoins, la volatilité du marché et leur potentiel de refuge ou d'incitation au risque. Les sources des données et leurs descriptions sont détaillées ci-dessous.

- **Volatilité du marché des crypto-monnaies** (*Crypto Volatility Index*), en pourcentage, variable quantitative :  
  *Source :* https://www.investing.com/indices/crypto-volatility-index-historical-data 

  \underline{Description :} Cet indice mesure les fluctuations du marché des crypto-monnaies sur une période donnée, exprimées en pourcentage. Une volatilité élevée reflète une incertitude accrue qui pourrait influencer l'attractivité de l'USDT en tant que refuge.

- **Dominance globale du marché** (*Global Market Dominance*), ratio, variable quantitative :  
  *Source :* https://coinmarketcap.com/currencies/tether/historical-data/

  \underline{Description :} Cette variable est définie comme le rapport entre la capitalisation de marché de Tether (*Tether Market Cap*) et la capitalisation totale du marché des crypto-monnaies (*Global Market Cap*). Elle permet d'interpréter la position relative de l'USDT parmi l'ensemble des actifs numériques et son rôle en tant qu'instrument dominant ou refuge.

- **Capitalisation totale du marché des crypto-monnaies** (*Global Market Cap*), en dollars américains, variable quantitative :  
  *Source :* https://www.coingecko.com/en/global-charts

  \underline{Description :} Bien que cette variable représente la valeur totale de toutes les crypto-monnaies combinées, elle ne sera pas utilisée directement dans l’analyse car elle est uniquement employée pour calculer la dominance globale du marché (*Global Market Dominance*), qui est plus pertinente pour cette étude.
  
\newpage

# Modélisation univariée

## Importations

### Importation des librairies

```{r}
library(ggplot2)
library(dplyr)
library(scales)
library(readxl)
library(urca)
library(kableExtra)
library(gridExtra)
library(forecast)
library(lmtest)
library(knitr)
library(tseries)
library(FinTS)
library(vars)
library(lpirfs)
library(tsDyn)
```

### Importation de la base de données

```{r}
# Importation des données
rm(list=ls())  # on vide l'environnement global

data <- read_excel("tether_market_dominance.xlsx")
# Conversion de la colonne 'timeClose' en date
data$timeClose <- as.Date(data$timeClose, format = "%Y-%m-%d")
```

Nous affichons nos tableaux via `kable` qui nous permet d'obtenir une belle présentation.

```{r echo=FALSE}
kable(head(data), format = 'latex', booktabs = TRUE) %>% 
  kable_styling(full_width = FALSE, latex_options = c('hold_position', 'striped')) # Affichage de l'aperçu des données
```
\newpage
## Représentation graphique des variables

```{r}
# Préparation des données
df_filtre <- data %>%
  filter(timeClose >= as.Date("2020-01-01") & timeClose < as.Date("2024-01-01")) %>%
  mutate(
    V = crypto_volatility_index,                   # Volatilité
    MD = global_market_dominance * 100,            # Market Dominance (%)
    LV = log(crypto_volatility_index),             # Log Volatilité
    LMD = log(global_market_dominance * 100)       # Log Market Dominance
  )

# Vérification que les dates sont bien triées 
df_filtre <- df_filtre %>%
  arrange(timeClose) 

# Transformation en séries temporelles hebdomadaires
# Fréquence pour données hebdomadaires = 52 
LV <- ts(
  df_filtre$LV, 
  start = c(2020, as.numeric(format(min(df_filtre$timeClose), "%U")) + 1), 
  frequency = 52
)
LMD <- ts(
  df_filtre$LMD, 
  start = c(2020, as.numeric(format(min(df_filtre$timeClose), "%U")) + 1), 
  frequency = 52
)

# Volatilité du marché
p1 <- ggplot(df_filtre, aes(x = timeClose, y = V)) +
  geom_line(color = 'red') +
  labs(title = "Volatilité du marché", x = "Date", y = "Volatilité (%)") +
  theme_minimal()

# Dominance globale du marché
p2 <- ggplot(df_filtre, aes(x = timeClose, y = MD)) +
  geom_line(color = 'green') +
  labs(title = "Dominance globale", x = "Date", y = "Dominance (%)") +
  theme_minimal()

# Logarithme de la volatilité du marché
p3 <- ggplot(df_filtre, aes(x = timeClose, y = LV)) +
  geom_line(color = 'red') +
  labs(title = "Log(Volatilité)", x = "Date", y = "Log(Volatilité)") +
  theme_minimal()

# Logarithme de la dominance globale du marché
p4 <- ggplot(df_filtre, aes(x = timeClose, y = LMD)) +
  geom_line(color = 'green') +
  labs(title = "Log(Dominance)", x = "Date", y = "Log(Dominance)") +
  theme_minimal()
```
\newpage
Les graphiques ci-dessous représentent les deux variables principales : la volatilité du marché des crypto-monnaies et la dominance globale du marché, ainsi que leurs transformations logarithmiques.
```{r fig.cap="Évolution des variables et leurs logarithmes", fig.align='center', fig.width=10, fig.height=6, echo=FALSE}
# Affichage combiné des graphiques
grid.arrange(p1, p2, p3, p4, ncol = 2)
```
La volatilité du marché des crypto-monnaies décroît globalement, avec des pics marqués en début de période, probablement liés aux incertitudes économiques causées par la pandémie et aux bulles spéculatives de 2021, suivis d'une stabilisation progressive.

La dominance globale de Tether sur le marché affiche une croissance rapide au début de la période, portée par une demande accrue pour les stablecoins en tant que refuge financier, avant de se stabiliser à un plateau plus élevé. 

Entre 2020 et 2023, ces évolutions traduisent les effets conjoints des crises comme l’effondrement de Terra-LUNA, des ajustements du marché et d’une adoption croissante de Tether dans les transactions crypto et la DeFi.

\newpage

## Autocorrélogrammes simples et partiels
Par la suite, nous travaillerons avec les variables transformées en logarithmes.

\bigskip

Pour approfondir l’analyse des dynamiques temporelles des variables étudiées, nous procédons à l’examen des autocorrélogrammes simples et partiels, afin d’identifier les dépendances temporelles et d’évaluer les structures potentielles d’autorégression.

\bigskip

```{r fig.cap="ACF des variables", fig.align='center', fig.width=10, fig.height=4}
# Réglage pour 2 graphiques ACF côte à côte 
par(mfrow = c(1, 2))

# ACF pour Volatilité du Marché
acf(LV, main = "ACF Volatilité du Marché", lag.max = 20)

# ACF pour Dominance Globale
acf(LMD, main = "ACF Dominance Globale", lag.max = 20)

# Réinitialisation de la disposition graphique
par(mfrow = c(1, 1))

```
Les autocorrélogrammes montrent une décroissance progressive des coefficients d'autocorrélation pour les deux variables log-transformées. Cette décroissance lente est caractéristique de séries non-stationnaires, avec des valeurs significatives au-delà des premiers lags. Cela indique une persistance dans les dynamiques temporelles des séries, qui nécessitera probablement des transformations ou différenciations pour atteindre la stationnarité.
\newpage
```{r fig.cap="PACF des variables", fig.align='center', fig.width=10, fig.height=4}
# Réglage pour 2 graphiques PACF côte à côte 
par(mfrow = c(1, 2))

# PACF pour Volatilité du Marché
pacf(LV, main = "PACF Volatilité du Marché", lag.max = 20)

# PACF pour Dominance Globale
pacf(LMD, main = "PACF Dominance Globale", lag.max = 20)

# Réinitialisation de la disposition graphique
par(mfrow = c(1, 1))

```
L'analyse des ACF montre une forte persistance au premier retard pour la volatilité et la dominance globale, ce qui reflète une dynamique autorégressive importante à court terme. Cette persistance pourrait indiquer que les investisseurs réagissent rapidement aux fluctuations récentes du marché, influençant à la fois la volatilité et la demande pour l'USDT. La décroissance rapide des corrélations après le premier retard suggère cependant que les ajustements aux chocs se font majoritairement sur le court terme. Cela confirme l'idée que les stablecoins comme l'USDT jouent un rôle immédiat de stabilisateur, sans impact durable sur la dynamique globale des crypto-monnaies. La volatilité du marché et la dominance globale peuvent être modélisées avec des modèles AR(1).

\newpage

## Test de racine unitaire

\bigskip

L’analyse de la stationnarité des séries est essentielle pour éviter des résultats biaisés dans les modèles économétriques. Cette section applique des tests de racine unitaire (ADF et KPSS) pour vérifier la présence de non-stationnarité et identifier les transformations nécessaires, telles que la différenciation, afin d’assurer la robustesse des analyses.

\bigskip

Dans le test ADF, nous formulons les hypothèses suivantes :  
\[
H_0: \text{La série présente une racine unitaire (non-stationnaire).}
\]
\[
H_1: \text{La série est stationnaire.}
\]

Ensuite, nous appliquons le test KPSS pour vérifier la stationnarité. Les hypothèses sont inversées par rapport au test ADF :  
\[
H_0: \text{La série est stationnaire.}
\]
\[
H_1: \text{La série n'est pas stationnaire.}
\]

Ces tests complémentaires permettent d’obtenir une évaluation robuste de la stationnarité des séries temporelles étudiées.

```{r, results='asis'}
# Test de racine unitaire avec stratégie séquentielle pour les deux variables
# Fonction de résumé personnalisé

resume <- function(urdf_object, model_type = "Modèle non spécifié") {
  test_stat <- urdf_object@teststat
  critical_values <- urdf_object@cval
  
  # Nombre de statistiques disponibles
  n_stats <- length(test_stat)
  
  if (n_stats == 1) {
    # Cas du Modèle 1
    return(data.frame(
      Modèle = model_type,
      `Valeur critique (5%)` = critical_values[2],
      `Valeur calculée` = test_stat[1],
      Conclusion = ifelse(test_stat[1] < critical_values[2], "Rejet de H0", "Non rejet de H0")
    ))
  } else {
    # Cas des Modèles 2 et 3
    interpretations <- sapply(1:n_stats, function(i) {
      if (i == 1) {
        if (test_stat[i] < critical_values[2, i]) "Rejet de H0" else "Non rejet de H0"
      } else {
        if (test_stat[i] > critical_values[2, i]) "Significatif" else "Non significatif"
      }
    })
    return(data.frame(
      Modèle = model_type,
      Statistique = c("tau (z.lag1)", "phi2 (Intercept)", "phi3 (Trend)")[1:n_stats],
      `Valeur critique (5%)` = critical_values[2, 1:n_stats],
      `Valeur calculée` = test_stat[1:n_stats],
      Conclusion = interpretations
    ))
  }
}
resume_kpss <- function(kpss_object) {
  stat <- kpss_object@teststat
  crit_values <- kpss_object@cval
  data.frame(
    "Statistique" = stat,
    "Valeur critique (1%)" = crit_values[1],
    "Valeur critique (5%)" = crit_values[2],
    "Valeur critique (10%)" = crit_values[3],
    "Conclusion" = ifelse(stat < crit_values[2], "Stationnaire", "Non stationnaire")
  )
}

# Modèle 3 : Avec tendance pour Volatilité du Marché
adf_M3_volatilite <- ur.df(y = LV, type = "trend", selectlags = 'AIC')
kable(
  resume(adf_M3_volatilite, model_type = "Modèle 3"),
  caption = "Test ADF pour Volatilité du Marché (Modèle 3)"
)

# Modèle 2 : Avec dérive pour Volatilité du Marché
adf_M2_volatilite <- ur.df(y = LV, type = "drift", selectlags = 'AIC')
kable(
  resume(adf_M2_volatilite, model_type = "Modèle 2"),
  caption = "Test ADF pour Volatilité du Marché (Modèle 2)"
)

# Modèle 1 : Sans dérive ni tendance pour Volatilité du Marché
adf_M1_volatilite <- ur.df(y = LV, type = "none", selectlags = 'AIC')
kable(
  resume(adf_M1_volatilite, model_type = "Modèle 1"),
  caption = "Test ADF pour Volatilité du Marché (Modèle 1)"
)

# Test KPSS pour la stationnarité de la volatilité du marché
kpss_test_volatilite <- ur.kpss(y = LV, type = "mu", lags = "short")
kable(resume_kpss(kpss_test_volatilite), caption = "Test KPSS pour la stationnarité de la série Volatilité")

# Test KPSS pour la stationnarité de la volatilité du marché différenciée
LV_diff <- diff(LV)
kpss_test_volatilite_diff<- ur.kpss(y = LV_diff, type = "mu", lags = "short")
kable(resume_kpss(kpss_test_volatilite_diff), caption = "Test KPSS pour la stationnarité de la série différenciée (Volatilité)")
```
Le processus de tests ADF sur la volatilité du marché a montré que ni le Modèle 3 (avec tendance et constante), ni le Modèle 2 (avec dérive uniquement), ni le Modèle 1 (sans dérive ni tendance) n'étaient suffisants pour garantir la stationnarité de la série. En appliquant une différenciation, nous avons finalement atteint la stationnarité, indiquant que la volatilité est un processus $I(1)$. Ce processus est nécessaire pour garantir la validité de nos modèles économétriques, car il élimine les biais associés aux séries non stationnaires et permet des analyses plus robustes sur les relations entre la volatilité du marché et la dominance des stablecoins.
```{r, results='asis'}
# Modèle 3 : Avec tendance pour Dominance Globale
adf_M3_dominance <- ur.df(y = LMD, type = "trend", selectlags = 'AIC')
kable(
  resume(adf_M3_dominance, model_type = "Modèle 3"),
  caption = "Test ADF pour Dominance Globale (Modèle 3)"
)

# Modèle 2 : Avec dérive pour Dominance Globale
adf_M2_dominance <- ur.df(y = LMD, type = "drift", selectlags = 'AIC')
kable(
  resume(adf_M2_dominance, model_type = "Modèle 2"),
  caption = "Test ADF pour Dominance Globale (Modèle 2)"
)

# Modèle 1 : Sans dérive ni tendance pour Dominance Globale
adf_M1_dominance <- ur.df(y = LMD, type = "none", selectlags = 'AIC')
kable(
  resume(adf_M1_dominance, model_type = "Modèle 1"),
  caption = "Test ADF pour Dominance Globale (Modèle 1)"
)

# Test KPSS pour la stationnarité de la dominance globale
kpss_test_dominance <- ur.kpss(y = LMD, type = "mu", lags = "short")
kable(resume_kpss(kpss_test_dominance), caption = "Test KPSS pour la stationnarité de la série Dominance Globale")#

# Test KPSS pour la stationnarité de la dominance globale différenciée
LMD_diff <- diff(LMD)
kpss_test_dominance_diff <- ur.kpss(y = LMD_diff, type = "mu", lags = "short")
kable(resume_kpss(kpss_test_dominance_diff), caption = "Test KPSS pour la stationnarité de la série différenciée (Dominance Globale)")
```
Le test ADF appliqué à la dominance globale n'a pas permis de rejeter l'hypothèse de racine unitaire, ce qui indique que la série n'est pas stationnaire. De plus, le test KPSS confirme la non-stationnarité de la série en rejetant l'hypothèse nulle de stationnarité.

Les résultats des tests ADF et du test KPSS montrent que la série différenciée n'est pas stationnaire au seuil de 5% (bien qu'elle le soit au seuil de 10%).
Par conséquent, nous procédons à une deuxième différenciation de la série avant de tester à nouveau sa stationnarité.
```{r echo=FALSE}
# Différenciation de deuxième ordre
LMD_diff2 <- diff(diff(LMD)) # Deuxième différenciation

# Test ADF pour la série différenciée deux fois
adf_M3_diff2 <- ur.df(y = LMD_diff2, type = "trend", selectlags = 'AIC')
kable(
  resume(adf_M3_diff2, model_type = "Modèle 3 (différencié 2 fois)"),
  caption = "Test ADF pour Dominance Globale différenciée deux fois (Modèle 3)"
)

# Test KPSS pour la série différenciée deux fois
kpss_test_diff2 <- ur.kpss(y = LMD_diff2, type = "mu", lags = "short")
kable(
  resume_kpss(kpss_test_diff2),
  caption = "Test KPSS pour la stationnarité de la série différenciée deux fois (Dominance Globale)"
)
```
Les résultats des tests ADF appliqués à la dominance globale différenciée deux fois montrent que, pour le modèle 3, \(H_0\) est rejetée pour le test \(\tau\), indiquant l'absence de racine unitaire. Les statistiques associées à l'intercept (\(\phi_2\)) et à la tendance quadratique (\(\phi_3\)) sont significatives, confirmant l'importance de ces composantes dans la dynamique de la série.

L'identification d'une tendance quadratique avant différenciation souligne un aspect structurel de l'évolution de la dominance de Tether sur le marché des crypto-monnaies. Dans un cadre économique, cela reflète la manière dont Tether s'est affirmé comme un refuge pour les investisseurs, en particulier lors de périodes marquées par une volatilité accrue. Les crises, comme l'effondrement de Terra-Luna ou les bulles spéculatives de 2021, ont renforcé son rôle de stabilisateur sur un marché intrinsèquement instable.

La stationnarité obtenue après une double différenciation (\(I(2)\)) indique également que la dominance globale de Tether est influencée par des tendances de long terme, probablement liées à des facteurs comme l'augmentation de la demande pour les stablecoins dans la DeFi ou les ajustements face aux chocs macroéconomiques globaux. Ces observations permettent de mieux comprendre le positionnement stratégique des stablecoins et leur rôle dans les décisions d’investissement, oscillant entre refuge financier et incitation au risque.

\newpage

## Identification du modèle ARMA pour \( LMD_{\text{diff2}} \)

Nous allons étudier la série \( \text{LMD}_{\text{diff2}} \), correspondant à la dominance du Tether différenciée deux fois. Cette variable, centrale à notre analyse, permet de modéliser la dynamique temporelle de la dominance de Tether tout en garantissant la stationnarité, essentielle pour identifier un modèle ARMA satisfaisant.

```{r fig.cap="ACF et PACF de la variable Dominance du Tether différenciée deux fois", fig.align='center', fig.width=10, fig.height=4}

# Réglage pour 2 graphiques ACF et PACF côte à côte 
par(mfrow = c(1, 2))

# ACF pour Domination du de Tether différenciée deux fois
acf(LMD_diff2, main = "ACF Domination du Tether", lag.max = 20)
# PACF pour Domination de Tether différenciée deux fois
pacf(LMD_diff2, main = "PACF Domination du Tether", lag.max = 20)
par(mfrow = c(1, 1))
# Initialisation des matrices pour stocker les critères AIC et BIC
mat_aic <- matrix(NA, nrow = 5, ncol = 5)
mat_bic <- matrix(NA, nrow = 5, ncol = 5)

# Boucle pour explorer les modèles ARMA(p,q)
for (i in 0:4) {
  for (j in 0:4) {
    # Ajustement du modèle ARMA(i, j)
    ARMA_ij <- Arima(y = LMD_diff2, order = c(i, 0, j), method = "ML")
    # Stockage des critères dans les matrices
    mat_aic[i + 1, j + 1] <- ARMA_ij$aic
    mat_bic[i + 1, j + 1] <- ARMA_ij$bic
  }
}

# Nommer les lignes et colonnes des matrices
rownames(mat_aic) <- paste0("p=", 0:4)
colnames(mat_aic) <- paste0("q=", 0:4)
rownames(mat_bic) <- paste0("p=", 0:4)
colnames(mat_bic) <- paste0("q=", 0:4)

# Affichage des matrices
kable(mat_aic, caption = "Matrice des critères AIC", format = "latex", booktabs = TRUE)
kable(mat_bic, caption = "Matrice des critères BIC", format = "latex", booktabs = TRUE)

# Identifier les meilleurs modèles selon AIC et BIC
best_aic <- which(mat_aic == min(mat_aic, na.rm = TRUE), arr.ind = TRUE)
best_bic <- which(mat_bic == min(mat_bic, na.rm = TRUE), arr.ind = TRUE)

cat("Meilleur modèle selon AIC : ARMA(", best_aic[1] - 1, ",", best_aic[2] - 1, ")\n")
cat("Meilleur modèle selon BIC : ARMA(", best_bic[1] - 1, ",", best_bic[2] - 1, ")\n")
```
Après avoir comparé plusieurs modèles selon les critères AIC et BIC, le modèle \textbf{$MA(1)$} a été retenu comme le plus approprié pour modéliser la série $LMD_{\text{diff2}}$. Bien que ce modèle présente une structure simple, il satisfait aux conditions essentielles, notamment l'absence d'autocorrélation des résidus (test de Ljung-Box, $p = 0.3577$). Cependant, il est à noter que l’un des tests formels indique la présence d’effets ARCH, suggérant une hétéroscédasticité des résidus. Malgré cela, la simplicité et la significativité des coefficients estimés renforcent la pertinence de ce modèle pour cette analyse. 


\newpage
```{r}
# Fonction pour afficher les résumés 
afficher_resume <- function(modele, titre = "Résumé du modèle") {
    # Extraction des critères importants
    criteres <- c("AIC" = modele$aic, "BIC" = modele$bic, 
                  "Log-Vraisemblance" = modele$loglik, "Sigma^2" = modele$sigma2)
    criteres <- na.omit(criteres)  # Supprime les valeurs nulles
    # Création du tableau des résultats
    kable(
        data.frame("Critères" = names(criteres), "Valeurs" = round(criteres, 4)), 
        caption = titre, 
        format = "latex", 
        booktabs = TRUE, 
        label = gsub(" ", "_", tolower(titre))
    ) %>%
        kable_styling(latex_options = c("hold_position", "striped"), font_size = 8) %>%
        column_spec(2, width = "5em")  # Réduit la largeur des colonnes
}

# Modèle MA(1)
MA1 <- Arima(y = LMD_diff2, order = c(0, 0, 1), method = "CSS-ML")
afficher_resume(MA1, titre = "Résumé du modèle MA(1)")
coeftest(MA1)
```
Le modèle \textbf{$MA(1)$} présente un AIC de \(-327.2668\) et un BIC de \(-319.0846\), indiquant un bon compromis entre qualité d'ajustement et simplicité. La log-vraisemblance (\(166.6334\)) et la faible variance des résidus (\(\sigma^2 = 0.0030\)) confirment que le modèle capture efficacement les dynamiques temporelles des données. De plus, les coefficients estimés sont significatifs au seuil de 5\%, renforçant la robustesse de ce modèle.


```{r}

#Résidus du modèle MA(1)
residus_MA1 <- residuals(MA1)

# 1. Test de Ljung-Box (Autocorrélation des résidus)
check_res <- checkresiduals(residus_MA1, lags = 20) 

# 2. Test de Engle (Hétéroscédasticité des résidus) - Test ARCH
arch_test <- ArchTest(residus_MA1, lags = 10) 
print(arch_test)
```
\newpage
```{r}
# 3. Test de Jarque-Bera (Normalité des résidus)
jb_test <- jarque.bera.test(residus_MA1)
print(jb_test)
```
Après avoir testé de nombreux modèles ARIMA sur les deux séries temporelles, en variant largement les paramètres (\(p, d, q\)) via des boucles, aucun modèle ne satisfaisait simultanément les trois tests : Ljung-Box, Engle (ARCH) et Jarque-Bera. Le modèle \textbf{MA(1)} a été retenu car il élimine l'autocorrélation des résidus (Ljung-Box, \(p = 0.3577\)), bien qu'il présente des effets ARCH (\(p = 0.001544\)) et une non-normalité (Jarque-Bera, \(p < 10^{-8}\)). Ces difficultés soulignent la complexité des séries financières, influencées par des dynamiques de marché non linéaires et des chocs imprévisibles.

\bigskip

L’analyse visuelle des résidus montre une distribution globalement symétrique, avec un histogramme et une densité qui se rapprochent d’une loi normale, bien que les tests formels rejettent cette hypothèse. De plus, l’autocorrélation des résidus est contenue dans les intervalles de confiance pour presque tous les retards, renforçant l’idée que le modèle capte bien les dynamiques principales de la série. Ces observations confirment que, malgré ses limites, le modèle MA(1) fournit une approximation satisfaisante pour cette étude.


\newpage

## Prévisions de la série modélisée

\bigskip

Dans cette section, nous calculons les prévisions de la série temporelle modélisée pour les horizons de 1 à 3, en utilisant la série différenciée deux fois.
```{r}
# Prévisions avec le modèle MA(1)
forecast_MA1 <- forecast(MA1, h = 3, level = 95)
autoplot(forecast_MA1)
```
Les prévisions obtenues à partir du modèle MA(1) montrent une stabilité relative de la croissance de la dominance du Tether sur les trois horizons futurs, avec des intervalles de confiance modérés, reflétant une incertitude maîtrisée malgré la volatilité passée de la série.

\newpage

# Modélisation Mutivariée

\bigskip

## Estimation du modèle VAR et sélection des retards optimaux

```{r}
# On crée un bloc de séries temporelles (Log-volatilité différenciée, Log-Dominance différenciée 2 fois)
data_var <- cbind(LV_diff, LMD_diff2)

# Supprimer les lignes contenant des NA
data_var <- na.omit(data_var)

# Sélection des retards
VARselect_none <- VARselect(data_var, lag.max = 15, type = "none")

# Résultats
print(VARselect_none)

```
Les résultats des tests de stationnarité ont montré une stationnarité des séries après différentiation. Les graphiques et les autocorrélogrammes des séries stationnarisées indiquent qu’elles oscillent autour de zéro sans niveau moyen significatif ni tendance linéaire. Par conséquent, aucune composante déterministe n’est nécessaire dans le modèle VAR. De plus, les critères d’information (AIC, BIC, HQ et FPE) favorisent un modèle sans composante déterministe (type = "none"), ce qui confirme l’adéquation de cette approche. 

L'étude des critères d'information suggère le choix d'un modèle VAR à 3 retards. Ce niveau minimise les critères d'information AIC, Hannan-Quinn et FPE, tout en étant proche de la valeur minimale pour le critère de Schwarz (obtenu à 1 retard).

```{r}
VAR1 <- VAR(y = data_var,type="const",lag.max = 3)
summary(VAR1)
```
Le modèle VAR(3) obtenu est stable car toutes les racines du polynôme caractéristique sont inférieures à 1.

On étudie dans un premier temps l'équation obtenue pour la log-volatilité de marché différenciée (\text{LV\_diff}) :

Le coefficient du premier retard (\text{LV\_diff.l1}) est positif mais non significatif ($p > 0.05$), indiquant une absence d’autocorrélation immédiate significative. Le coefficient du troisième retard (\text{LV\_diff.l3}) est négatif et significatif ($p = 0.049$), indiquant un effet correctif significatif après trois périodes. Aucun des retards de la dominance de marché (\text{LMD\_diff2}) n’est significatif dans cette équation ($p > 0.05$), suggérant que la dominance de marché n’a pas d’effet direct sur la volatilité. Le $R^2$ ajusté est égal à $0.065$, indiquant que cette équation explique très peu la variabilité de \text{LV\_diff}. Les dynamiques de volatilité semblent largement influencées par des facteurs exogènes.

On étudie ensuite l'équation obtenue pour la log-dominance de marché doublement différenciée (\text{LMD\_diff2}) :

Le coefficient du premier retard (\text{LV\_diff.l1}) est négatif et significatif ($p = 0.010$), indiquant que la volatilité passée a un effet négatif immédiat sur la dominance. Le coefficient du troisième retard (\text{LV\_diff.l3}) est également négatif et significatif ($p = 0.019$), suggérant un effet prolongé de la volatilité sur la dominance. Les coefficients des retards de \text{LMD\_diff2} sont tous négatifs et fortement significatifs ($p < 0.01$), indiquant une forte autocorrélation et des ajustements correctifs au sein de la dominance de marché. Le $R^2$ ajusté est égal à $0.354$, indiquant que l’équation possède un pouvoir explicatif modéré des variations de \text{LMD\_diff2}, conformément à l'intuition générale de notre projet.

De plus, la corrélation entre les résidus ($0.2438$) est modérée, suggérant une interaction limitée entre les équations en termes de bruit non expliqué. Cette hypothèse est renforcée par les faibles valeurs de la matrice des covariances des résidus.


## Relations de causalité entre les variables de Xt

On peut se demander si une variable est causée par une autre variable. On procède au test de Granger:

```{r}
# Test de causalité de Granger pour LV_diff -> LMD_diff2
causality(VAR1, cause = "LV_diff")

# Test de causalité de Granger pour LMD_diff2 -> LV_diff
causality(VAR1, cause = "LMD_diff2")

```
Le test de causalité de Granger de \text{LV\_diff} sur \text{LMD\_diff2} renvoie une p-value inférieure à $0.05$ ($0.0157$). On rejette donc l'hypothèse nulle au seuil de $5\%$. \text{LV\_diff} cause \text{LMD\_diff2} au sens de Granger.

Le test de causalité de Granger de \text{LMD\_diff2} sur \text{LV\_diff} renvoie une p-value égale à $0.5001$. On ne rejette pas l'hypothèse nulle au seuil de $5\%$. \text{LMD\_diff2} ne cause pas \text{LV\_diff} au sens de Granger.

Conformément à notre intuition initiale, la connaissance des valeurs passées de la log-volatilité différenciée améliore la prévision de la log-dominance de marché de Tether doublement différenciée. La réciproque n'est pas vérifiée.

## Analyse impulsion-réponse des chocs sur les variables

### Méthode des VAR

La fonction de réponse d’un VAR retrace l’effet d’un choc en t sur l’une des variables sur les valeurs présentes et futures de cette variable et des autres variables du VAR.

```{r fig.cap="Réponses impulsionnelles du modèle VAR", fig.align='center', fig.width=8, fig.height=4, echo=FALSE}
irf<-irf(VAR1,n.ahead = 12,ortho = TRUE,ci=0.95)
plot(irf)
```

\newpage

Conformément aux attentes relatives à un modèle VAR stationnaire, on observe que l'effet du choc sur \text{LV\_diff} décroît progressivement et tend vers $0$ après environ $4$ à $6$ périodes. L'effet du choc est transitoire et ne persiste pas à long terme. Les intervalles de confiance au seuil de $5\%$ montrent que l'effet n'est plus significatif après $3$ périodes.

D'après le graphique, le choc sur \text{LV\_diff} a un effet très modéré sur \text{LMD\_diff2}. D'après les intervalles de confiance, celui-ci est non significatif sauf en temps $1$.

Le choc initial sur \text{LMD\_diff2} a un effet négatif immédiat. On observe une chute marquée sur la première période. L'effet se dissipe très rapidement et est non significatif dès la deuxième période. L'effet du choc de \text{LMD\_diff2} sur \text{LV\_diff} est non significatif.

Les résultats de l'analyse impulsion-réponse par la méthode des VAR montrent donc une transmission limitée des chocs entre \text{LV\_diff} et \text{LMD\_diff2}, mais une forte réponse intra-variable.


### Méthode des projections locales de Jorda

L'analyse antérieure du modèle VAR adapté à nos variables suggère un modèle à $3$ retards. La construction du VAR structurel implique de ranger les variables de la plus exogène à la plus endogène. Dans le cadre de ce projet, nous considérons l'impact de la volatilité du marché des cryptomonnaies sur la dominance globale du stablecoin USDT. On choisit donc de placer en premier la log-volatilité différenciée, avant la log-dominance de marché doublement différenciée. La variable \text{var\_data} convient donc dans ce cas. On simule un choc de taille $1$ (\text{shock\_type=1}).

```{r}
irf_LP<-lp_lin(endog_data = as.data.frame(data_var),
               lags_endog_lin=3,
               trend=0,
               shock_type=1,
               confint=1.96,
               hor=10)
plot(irf_LP)
```
La réponse de \text{LV\_diff} à un choc immédiat est positive et très forte (valeur proche de $1$ au premier retard), indiquant une autocorrélation immédiate importante. Après ce pic initial, la réponse décroît rapidement, devenant négative au deuxième retard et tendant vers zéro à partir du quatrième retard, ce qui traduit un effet correctif des chocs passés sur la volatilité. L’effet des chocs n'est plus significatif après le quatrième retard, comme le montre l’inclusion de la courbe dans la zone d’incertitude.

La réponse immédiate de \text{LV\_diff} à un choc sur \text{LMD\_diff2} est légèrement négative au deuxième retard, bien qu’elle devienne ensuite insignifiante. Les variations immédiates de la dominance n’affectent pas directement la volatilité.

La réponse initiale de \text{LMD\_diff2} à un choc sur \text{LV\_diff} est positive mais faible, suivie d’une oscillation autour de zéro sans effet significatif à long terme. Cela montre que les variations de la volatilité influencent peu la dominance de marché à court terme.

La réponse de \text{LMD\_diff2} à un choc immédiat est très forte et positive (valeur proche de $1$ au premier retard), indiquant une forte autocorrélation immédiate. Cette réponse décroît rapidement, devenant négative au deuxième retard, et présente des oscillations faibles mais significatives à long terme. Les ajustements correctifs après un choc initial traduisent un phénomène de réversion vers la moyenne typique des séries stationnaires.

De plus, les zones d’incertitude grises montrent que la plupart des réponses après le quatrième ou cinquième retard deviennent insignifiantes, confirmant que les dynamiques entre \text{LV\_diff} et \text{LMD\_diff2} sont surtout dominées par des effets à court terme.

\newpage

## Cointégration

Pour effectuer un test de cointégration, il est nécessaire que les séries temporelles soient intégrées du même ordre. La série de log-volatilité du marché des cryptomonnaies \text{LV} est intégrée d'ordre $1$. La série de log-dominance de marché de Tether, \text{LMD}, est intégrée d'ordre $2$. Nous allons donc utiliser la série différenciée \text{LMD\_diff} qui est intégrée d'ordre $1$, et procéder au test de cointégration de Johansen. On dispose d'une série manifestant une tendance linéaire (\text{LV}), ainsi qu'une série dont le niveau oscille autour de $0$ (\text{LMD\_diff}). On opte donc pour un test avec constante dans l'équation de cointégration.


```{r}
data_johansen<-cbind(LV,LMD_diff)

johansen<-ca.jo(data_johansen,
                ecdet='const',
                spec='transitory',
                type='trace',
                K=3)
summary(johansen)
```
La statistique de trace pour l'hypothèse ($r=0$) est de $35.18$, ce qui est supérieur à la valeur critique de $19.96$ au seuil de $5\%$. Cela permet de rejeter l'hypothèse nulle et de conclure qu'il existe au moins une relation de cointégration entre les variables.

La statistique de trace pour l'hypothèse selon laquelle il y a au plus $1$ relation de cointégration ($r\leq1$) est de $3.78$. Elle est inférieure à la valeur critique de $9.24$ au seuil de $5\%$. Cela conduit à ne pas rejeter l'hypothèse nulle. Il n'existe pas de deuxième relation de cointégration significative au seuil de $5\%$.

Les vecteurs propres révèlent des relations de cointégration stables entre les variables, où la différence de la deuxième variable et une constante jouent un rôle clé dans le maintien de l'équilibre à long terme. La matrice des poids montre que \text{LV.d} contribue peu aux ajustements des déséquilibres, tandis que la différence de \text{LMD\_diff} est le principal moteur de la correction.

Ces résultats confirment la présence de cointégration et justifient l'utilisation d'un modèle à correction d'erreur pour capturer les dynamiques à court et long terme. Le modèle VAR précédemment calculé utilise les variables différenciées donc affranchies des relations de cointégration et n'est pas invalidé.

Néanmoins, le test de Johansen indique que le modèle VAR avec des séries différenciées ne capture pas les ajustements vers l'équilibre à long terme entre vos variables, car la cointégration a été exclue du modèle. Il reste valide pour l'analyse des dynamiques à court terme, mais la construction d'un modèle VECM (Vector Error Correction Model) peut être pertinente.


### Estimation du modèle VECM

On estime un VECM portant sur les séries \text{LV} et \text{LMD\_diff}, intégrées d'ordre $1$ et exhibant $1$ relation de cointégration ($r=1$). La dynamique de court terme et la relation de cointégration incluent une constante et une tendance, d'où le choix des paramètres (\text{include='both', LRinclude='none'}).


```{r}
data_johansen<-na.omit(data_johansen)
vecm<-VECM(data=data_johansen,
           lag=2,
           r=1,
           estim='ML',
           include='both',
           LRinclude='none')
summary(vecm)
```
On calcule les t-statistiques à partir du coefficients estimé et standard error pour chaque coefficient:

```{r}
# Coefficients et erreurs standards
coefficients <- c(-0.0084, -0.0471, 0.0325, 0.2499, 2.1e-05, -0.0008, 
                  0.1802, -0.0912, 0.2580, 0.2044, -0.1728, 0.0679, 0.0756, 0.0484)
errors <- c(0.0114, 0.0072, 0.0626, 0.0394, 0.0003, 0.0002, 
            0.1015, 0.0639, 0.2085, 0.1311, 0.1024, 0.0644, 0.1514, 0.0952)
variables <- c("ECT (Equation LV)", "ECT (Equation LMD_diff)", "Intercept (Equation LV)", 
               "Intercept (Equation LMD_diff)", "Trend (Equation LV)", "Trend (Equation LMD_diff)", 
               "LV -1 (Equation LV)", "LV -1 (Equation LMD_diff)", "LMD_diff -1 (Equation LV)", 
               "LMD_diff -1 (Equation LMD_diff)", "LV -2 (Equation LV)", "LV -2 (Equation LMD_diff)", 
               "LMD_diff -2 (Equation LV)", "LMD_diff -2 (Equation LMD_diff)")

ddl <- 111

# Calcul des t-statistiques et p-valeurs
t_stats <- coefficients / errors
p_valeurs <- 2 * (1 - pt(abs(t_stats), ddl))

# Création du tableau final
results <- data.frame(
  Variable = variables,
  Coefficient = coefficients,
  Std_Error = errors,
  t_Stat = t_stats,
  p_Value = p_valeurs
)

# Afficher le tableau
print(results)
```
Les coefficients du terme de correction d'erreur (ECT), de la constante (intercept), et de la tendance (trend) de la variable \text{LMD\_diff} ont une p-value inférieure à $0.001$ et sont donc fortement significatifs. Cela pourrait refléter la présence d'une dérive systématique ou d'un facteur externe affectant la dynamique de \text{LMD\_diff}.

Aucun des coefficients relatifs à l'équation \text{LV} n'est significatif au seuil de $5\%$.

Le modèle révèle donc que seule \text{LMD\_diff} réagit significativement aux déséquilibres à long terme. La constante et la tendance jouent un rôle significatif uniquement dans l'équation de cette variable. L'équation associée à la variable \text{LV} ne montre aucun ajustement significatif vers cet équilibre, ce qui suggère que la log-volatilité du marché des cryptos est davantage influencée par d'autres dynamiques non modélisées ou par des facteurs externes (encore une fois on pense aux tweets de Donald Trump).

Les dynamiques de court terme, représentées par les coefficients des retards, sont globalement non significatives. Cela indique que les effets à court terme entre \text{LV} et \text{LMD\_diff} sont faibles ou inexistants dans le cadre du modèle. Une exception notable est le premier retard de la variable \text{LV}, qui présente une faible autocorrélation, significative à un seuil de $10\%$ (p-value = $7.857758 \times 10^{-2}$).

Le modèle révèle une structure asymétrique entre \text{LV} et \text{LMD\_diff}. \text{LMD\_diff} agit comme la variable clé qui ajuste les déséquilibres à long terme, tandis que \text{LV} semble relativement inerte face à ces déséquilibres. Ce comportement pourrait suggérer que \text{LV} est davantage une variable exogène ou qu'elle est influencée par des facteurs à long terme qui ne sont pas explicitement inclus dans le modèle.

\newpage

# Conclusion

  Dans les analyses univariées, \text{LMD\_diff2} a été modélisée par un MA(1), confirmant que les chocs récents influencent fortement la dominance de marché. Ce résultat reflète la nature réactive des investisseurs face aux variations récentes des marchés des cryptomonnaies. Les prévisions obtenues avec ce modèle montrent une relative stabilité de la dominance de Tether dans les périodes futures à court terme, avec des intervalles de confiance modérés. Cela souligne le rôle de Tether comme refuge en période de turbulences, offrant une alternative stable dans un marché souvent volatil.

L’analyse multivariée, via un modèle VAR, a révélé des interactions asymétriques. La volatilité différenciée \text{LV\_diff} influence significativement la dominance \text{LMD\_diff2}, notamment via des effets immédiats et retardés. Cependant, l’inverse n’a pas été observé, soulignant que la volatilité joue un rôle moteur dans les dynamiques à court terme des stablecoins. Ce constat est cohérent avec le fait que les périodes de forte volatilité sur les marchés des cryptomonnaies augmentent la demande pour des actifs perçus comme plus sûrs, comme les stablecoins. Ces derniers servent alors de valeur refuge temporaire pour les investisseurs cherchant à minimiser leurs pertes.

Les résultats des fonctions impulsionnelles montrent une transmission limitée des chocs entre les deux variables, avec des effets transitoires qui disparaissent après quelques périodes. Cela confirme que, bien que la volatilité impacte la dominance des stablecoins, cet effet reste court et circonscrit. Les dynamiques identifiées sont fortement influencées par des facteurs externes tels que les régulations sur les cryptomonnaies, les annonces de marché, ou encore les événements macroéconomiques globaux. Par exemple, des décisions politiques ou des effondrements de projets crypto majeurs, comme Terra-LUNA, peuvent exacerber les fluctuations observées.

Notre analyse met également en évidence l’importance de l’offre et de la liquidité des stablecoins dans la gestion des portefeuilles en période de crise. En période de volatilité élevée, les investisseurs peuvent réduire leur exposition aux actifs plus risqués en augmentant leur position en stablecoins comme Tether. Toutefois, cette dynamique peut également encourager des comportements opportunistes ou spéculatifs lorsque la volatilité diminue, avec des flux retour vers des actifs plus risqués.

En conclusion, cette étude met en lumière le rôle stratégique des stablecoins comme Tether dans la stabilisation temporaire des portefeuilles des investisseurs face à la volatilité des marchés des cryptomonnaies. Si les stablecoins s’affirment comme des outils essentiels pour absorber les chocs à court terme, leurs interactions avec la volatilité nécessitent une attention particulière, notamment en ce qui concerne les implications à long terme pour les investisseurs et la stabilité des marchés.
